import os
from transformers import GPT2Tokenizer, GPT2Model

# Set the path to the lyrics file
lyrics_path = os.path.join("/path/to/lyrics/file", "J_Cole_lyrics.txt")

# Read the lyrics file and split it into lines
with open(lyrics_path, "r") as f:
    lines = f.readlines()

# Initialize lists to store the prompts and completions
prompts = []
completions = []

# Iterate through the lines of the file
for i, line in enumerate(lines):
    # If the line is empty, start a new verse
    if line.strip() == "":
        prompt = lines[i-1]
        completion = "".join(lines[i+1:i+3])
        prompts.append(prompt)
        completions.append(completion)

# Load the GPT-NEOX-20B model
model = GPT2Model.from_pretrained("eleutherAI/gpt-neox-20b")

# Load the GPT-NEOX-20B tokenizer
tokenizer = GPT2Tokenizer.from_pretrained("eleutherAI/gpt-neox-20b")

# Tokenize the prompts
input_ids = []
for prompt in prompts:
    encoded_prompt = tokenizer.encode(prompt, return_tensors="pt")
    input_ids.append(encoded_prompt)

# Tokenize the completions
target_ids = []
for completion in comple
